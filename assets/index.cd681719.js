import{b as e}from"./components.fc1d8498.js";import{F as l,u as a}from"./provide.45897597.js";import{a as t}from"./elements.f945da86.js";import{t as r,b as n,f as u}from"./shared.6d6b25a1.js";import{_ as o}from"./IconSfc.d1e88af2.js";import{q as s,r as i,p as c,b as d,y as m,x as v,d as p,o as h,c as b,a as V,n as g,F as f,j as S,O as y,m as _,h as F,z as k,t as x}from"./vendor.bac705d4.js";const C={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:function(e){return["always","normal","never"].includes(e)}},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},rules:{type:Array},onChange:{type:Function},onStart:{type:Function},onEnd:{type:Function},"onUpdate:modelValue":{type:Function}};var z,T;(T=z||(z={})).First="1",T.Second="2";const w=s({name:"VarSlider",components:{[l.name]:l},props:C,setup(l){const{bindForm:o,form:s}=a(),{errorMessage:p,validateWithTrigger:h,validate:b,resetValidation:V}=e(),g=i(null),f=i(0),S=i(!1),y=c({[z.First]:{startPosition:0,currentLeft:0,active:!1,percentValue:0},[z.Second]:{startPosition:0,currentLeft:0,active:!1,percentValue:0}}),_=d((()=>f.value/100*r(l.step))),F=d((()=>{let e=[{value:l.modelValue,enumValue:z.First}];return l.range&&n(l.modelValue)&&(e=[{value:l.modelValue[0],enumValue:z.First},{value:l.modelValue[1],enumValue:z.Second}]),e})),x=d((()=>{const{activeColor:e,range:a,modelValue:t}=l;return{width:`${a&&n(t)?Math.abs(t[0]-t[1]):t}%`,left:`${a&&n(t)?Math.min(t[0],t[1]):0}%`,background:e}})),C=d((()=>l.disabled||(null==s?void 0:s.disabled.value))),T=d((()=>l.readonly||(null==s?void 0:s.readonly.value))),w=(e,a)=>{var t;let u=[];const{step:o,range:s,modelValue:i,onChange:c}=l,d=r(o),m=Math.round(e/_.value)*d,v=y[a].percentValue;if(y[a].percentValue=m/d,s&&n(i)&&(u=a===z.First?[m,i[1]]:[i[0],m]),v!==m){const e=s?u:m;null==c||c(e),null==(t=l["onUpdate:modelValue"])||t.call(l,e),k((()=>h(["onChange"],"onChange",l.rules,l.modelValue)))}},L=e=>{const{range:a,modelValue:t,onEnd:r}=l;if(C.value||T.value)return;let u=[];y[e].currentLeft=y[e].percentValue*_.value,y[e].active=!1;const o=y[e].percentValue;a&&n(t)&&(u=e===z.First?[o,t[1]]:[t[0],o]),null==r||r(a?u:o),S.value=!1},M=()=>{const e=r(l.step);return isNaN(e)?(console.warn('[Varlet] Slider: type of prop "step" should be Number'),!1):e<1||e>100?(console.warn('[Varlet] Slider: "step" should be >= 0 and <= 100'),!1):parseInt(`${l.step}`,10)===e||(console.warn('[Varlet] Slider: "step" should be an Integer'),!1)},P=()=>{const{range:e,modelValue:a}=l;return e&&!n(a)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!e&&n(a)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):!(e&&n(a)&&a.length<2)||(console.error('[Varlet] Slider: "modelValue" should have two value'),!1)},N=(e=l.modelValue,a=r(l.step))=>{l.range&&n(e)?(y[z.First].percentValue=e[0]/a,y[z.First].currentLeft=y[z.First].percentValue*_.value,y[z.Second].percentValue=e[1]/a,y[z.Second].currentLeft=y[z.Second].percentValue*_.value):u(e)&&(y[z.First].currentLeft=e/a*_.value)};m([()=>l.modelValue,()=>l.step],(([e,l])=>{M()&&P()&&!S.value&&N(e,r(l))})),m(f,(()=>N())),v((()=>{M()&&P()&&(f.value=g.value.offsetWidth)}));return null==o||o({reset:()=>{var e;const a=l.range?[0,0]:0;null==(e=l["onUpdate:modelValue"])||e.call(l,a),V()},validate:()=>b(l.rules,l.modelValue),resetValidation:V}),{Thumbs:z,sliderEl:g,getFillStyle:x,isDisabled:C,errorMessage:p,thumbsProps:y,thumbList:F,showLabel:e=>"always"===l.labelVisible||"never"!==l.labelVisible&&y[e].active,start:(e,a)=>{var t;f.value||(f.value=g.value.offsetWidth),C.value||T.value||(null==(t=l.onStart)||t.call(l),S.value=!0,y[a].startPosition=e.touches[0].clientX)},move:(e,l)=>{if(C.value||T.value||!S.value)return;let a=e.touches[0].clientX-y[l].startPosition+y[l].currentLeft;y[l].active=!0,a<=0?a=0:a>=f.value&&(a=f.value),w(a,l)},end:L,click:e=>{if(C.value||T.value)return;if(e.target.closest(".var-slider__thumb"))return;const a=e.clientX-t(e.currentTarget),r=(e=>{if(!l.range)return z.First;const a=y[z.First].percentValue*_.value,t=y[z.Second].percentValue*_.value;return Math.abs(e-a)<=Math.abs(e-t)?z.First:z.Second})(a);w(a,r),L(r)}}}}),L={class:"var-slider"},M={class:"var-slider__track"},P=["onTouchstart","onTouchmove","onTouchend","onTouchcancel"];var N=o(w,[["render",function(e,l,a,t,r,n){const u=p("var-form-details");return h(),b("div",L,[V("div",{class:_(["var-slider-block",[e.isDisabled?"var-slider__disable":null,e.errorMessage?"var-slider__error":null]]),style:g({height:3*e.thumbSize+"px",margin:`0 ${e.thumbSize/2}px`}),ref:"sliderEl",onClick:l[0]||(l[0]=(...l)=>e.click&&e.click(...l))},[V("div",M,[V("div",{class:"var-slider__track-background",style:g({background:e.trackColor,height:e.trackHeight+"px"})},null,4),V("div",{class:"var-slider__track-fill",style:g(e.getFillStyle)},null,4)]),(h(!0),b(f,null,S(e.thumbList,(l=>(h(),b("div",{class:"var-slider__thumb",key:l.enumValue,style:g({left:`${l.value}%`,zIndex:e.thumbsProps[l.enumValue].active?1:null}),onTouchstart:a=>e.start(a,l.enumValue),onTouchmove:a=>e.move(a,l.enumValue),onTouchend:a=>e.end(l.enumValue),onTouchcancel:a=>e.end(l.enumValue)},[y(e.$slots,"button",{currentValue:l.value},(()=>[V("div",{class:"var-slider__thumb-block",style:g({background:e.thumbColor,height:e.thumbSize+"px",width:e.thumbSize+"px"})},null,4),V("div",{class:_(["var-slider__thumb-ripple",[e.thumbsProps[l.enumValue].active?"var-slider__thumb-ripple-active":null]]),style:g({background:e.thumbColor,height:e.thumbSize?e.thumbsProps[l.enumValue].active?3*e.thumbSize+"px":"0px":null,width:e.thumbSize?e.thumbsProps[l.enumValue].active?3*e.thumbSize+"px":"0px":null})},null,6),V("div",{class:_(["var-slider__thumb-label",[e.showLabel(l.enumValue)?"var-slider__thumb-label-active":null]]),style:g({background:e.labelColor,color:e.labelTextColor,height:2*e.thumbSize+"px",width:2*e.thumbSize+"px"})},[V("span",null,x(l.value),1)],6)]))],44,P)))),128))],6),F(u,{"error-message":e.errorMessage,class:"var-slider__form","var-slider-cover":""},null,8,["error-message"])])}]]);N.install=function(e){e.component(N.name,N)};export{N as S};
