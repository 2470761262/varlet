import{I as Z}from"./index.e6af7bd9.js";import{R as oe}from"./index.20a388b7.js";import{F as G,u as le}from"./provide.c69e772d.js";import{q as re,r as ie,b as H,y as se,Z as B,d as J,e as ue,o as de,c as me,a as K,i as k,h as F,m as O,n as M,Y as ce,P as ye,z as ve}from"./vendor.cfbfc887.js";import{l as ge,j as a,_ as he}from"./elevation.357f91b7.js";import{u as be}from"./components.190b2d1b.js";const fe={modelValue:{type:[String,Number],default:0},min:{type:[String,Number]},max:{type:[String,Number]},step:{type:[String,Number],default:1},color:{type:String},inputWidth:{type:[String,Number]},inputTextSize:{type:[String,Number]},buttonSize:{type:[String,Number]},decimalLength:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disableIncrement:{type:Boolean,default:!1},disableDecrement:{type:Boolean,default:!1},disableInput:{type:Boolean,default:!1},lazyChange:{type:Boolean,default:!1},incrementButton:{type:Boolean,default:!0},decrementButton:{type:Boolean,default:!0},press:{type:Boolean,default:!0},ripple:{type:Boolean,default:!0},validateTrigger:{type:Array,default:()=>["onInputChange","onLazyChange","onIncrement","onDecrement"]},rules:{type:Array},onBeforeChange:{type:Function},onChange:{type:Function},onIncrement:{type:Function},onDecrement:{type:Function},"onUpdate:modelValue":{type:Function}};const Q=100,R=600,pe=re({name:"VarCounter",components:{[Z.name]:Z,[G.name]:G},directives:{Ripple:oe},inheritAttrs:!1,props:fe,setup(e){const i=ie("");let p,z,S,T;const{bindForm:c,form:g}=le(),{errorMessage:V,validateWithTrigger:h,validate:X,resetValidation:D}=be(),{readonly:s,disabled:u}=g!=null?g:{},L=()=>X(e.rules,e.modelValue),C=n=>{ve(()=>{const{validateTrigger:t,rules:o,modelValue:r}=e;h(t,n,o,r)})},$=()=>{var t;const{min:n}=e;(t=e["onUpdate:modelValue"])==null||t.call(e,n!=null?a(n):0),D()},_={reset:$,validate:L,resetValidation:D},A=H(()=>{const{max:n,modelValue:t}=e;return n!=null&&a(t)>=a(n)}),E=H(()=>{const{min:n,modelValue:t}=e;return n!=null&&a(t)<=a(n)}),y=n=>{const{decimalLength:t,max:o,min:r}=e;let l=a(n);return o!=null&&l>a(o)&&(l=a(o)),r!=null&&l<a(r)&&(l=a(r)),n=String(l),t!=null&&(n=l.toFixed(a(t))),n},x=n=>{const{lazyChange:t,onBeforeChange:o}=e,{value:r}=n.target,l=y(r);t?o==null||o(a(l),I):v(l),C("onInputChange")},P=()=>{const{disabled:n,readonly:t,disableDecrement:o,decrementButton:r,lazyChange:l,step:w,modelValue:N,onDecrement:d,onBeforeChange:m}=e;if((u==null?void 0:u.value)||(s==null?void 0:s.value)||n||t||o||!r||E.value)return;const U=new B(a(N)).minus(new B(a(w))).toString(),b=y(U),f=a(b);d==null||d(f),l?m==null||m(f,I):(v(b),C("onDecrement"))},W=()=>{const{disabled:n,readonly:t,disableIncrement:o,incrementButton:r,lazyChange:l,step:w,modelValue:N,onIncrement:d,onBeforeChange:m}=e;if((u==null?void 0:u.value)||(s==null?void 0:s.value)||n||t||o||!r||A.value)return;const U=new B(a(N)).plus(new B(a(w))).toString(),b=y(U),f=a(b);d==null||d(f),l?m==null||m(f,I):(v(b),C("onIncrement"))},ee=()=>{const{press:n,lazyChange:t}=e;!n||t||(T=window.setTimeout(()=>{q()},R))},ne=()=>{const{press:n,lazyChange:t}=e;!n||t||(S=window.setTimeout(()=>{Y()},R))},te=()=>{z&&clearTimeout(z),T&&clearTimeout(T)},ae=()=>{p&&clearTimeout(p),S&&clearTimeout(S)},Y=()=>{p=window.setTimeout(()=>{W(),Y()},Q)},q=()=>{z=window.setTimeout(()=>{P(),q()},Q)},v=n=>{var o;i.value=n;const t=a(n);(o=e["onUpdate:modelValue"])==null||o.call(e,t)},I=n=>{v(y(String(n))),C("onLazyChange")};return c==null||c(_),se(()=>e.modelValue,n=>{var t;v(y(String(n))),(t=e.onChange)==null||t.call(e,a(n))}),v(y(String(e.modelValue))),{inputValue:i,errorMessage:V,formDisabled:u,formReadonly:s,isMax:A,isMin:E,validate:L,reset:$,resetValidation:D,handleChange:x,decrement:P,increment:W,pressDecrement:ee,pressIncrement:ne,releaseDecrement:te,releaseIncrement:ae,toSizeUnit:ge,toNumber:a}}}),ze={class:"var-counter var--box"},Se=["inputmode","readonly","disabled"];function Te(e,i,p,z,S,T){const c=J("var-icon"),g=J("var-form-details"),V=ue("ripple");return de(),me("div",ze,[K("div",ye({class:["var-counter__controller var-elevation--2",[e.disabled||e.formDisabled?"var-counter--disabled":null,e.errorMessage?"var-counter--error":null]],style:{background:e.color?e.color:void 0}},e.$attrs),[k(F(c,{class:O(["var-counter__decrement-button",[e.decrementButton?null:"var-counter--hidden"]]),"var-counter-cover":"",name:"minus",style:M({width:e.toSizeUnit(e.buttonSize),height:e.toSizeUnit(e.buttonSize)}),onClick:e.decrement,onTouchstart:e.pressDecrement,onTouchend:e.releaseDecrement,onTouchcancel:e.releaseDecrement},null,8,["class","style","onClick","onTouchstart","onTouchend","onTouchcancel"]),[[V,{disabled:!e.ripple||e.disabled||e.readonly||e.disableDecrement||!e.decrementButton||e.isMin}]]),k(K("input",{class:"var-counter__input",style:M({width:e.toSizeUnit(e.inputWidth),fontSize:e.toSizeUnit(e.inputTextSize)}),inputmode:e.toNumber(e.decimalLength)===0?"numeric":"decimal",readonly:e.readonly||e.formReadonly,disabled:e.disabled||e.formDisabled||e.disableInput,"onUpdate:modelValue":i[0]||(i[0]=h=>e.inputValue=h),onChange:i[1]||(i[1]=(...h)=>e.handleChange&&e.handleChange(...h))},null,44,Se),[[ce,e.inputValue]]),k(F(c,{class:O(["var-counter__increment-button",[e.incrementButton?null:"var-counter--hidden"]]),"var-counter-cover":"",name:"plus",style:M({width:e.toSizeUnit(e.buttonSize),height:e.toSizeUnit(e.buttonSize)}),onClick:e.increment,onTouchstart:e.pressIncrement,onTouchend:e.releaseIncrement,onTouchcancel:e.releaseIncrement},null,8,["class","style","onClick","onTouchstart","onTouchend","onTouchcancel"]),[[V,{disabled:!e.ripple||e.disabled||e.readonly||e.disableIncrement||!e.incrementButton||e.isMax}]])],16),F(g,{"error-message":e.errorMessage},null,8,["error-message"])])}var j=he(pe,[["render",Te]]);j.install=function(e){e.component(j.name,j)};export{j as C};
