import{S as O}from"./index.7c47e57d.js";import{q as P,r as c,b as x,T as Z,o as _,k as j,w as y,a as L,B as U,A as ee,I as ne,l as B,t as f,y as te,x as M,U as se,c as b,F as R,j as X,m as oe,n as F,z as ae,d as S,h as z}from"./vendor.7d218dee.js";import{b as re,e as le,a as ie,f as ce}from"./components.59a7770d.js";import{_ as D}from"./elevation.61c5e873.js";import{h as de,t as ue,g as fe}from"./shared.2d2ec151.js";import{h as ve,b as _e,s as me,n as he,r as pe}from"./elements.fbcbc1e3.js";import{C as V}from"./index.63e497fb.js";import{u as xe,a as H,_ as ye,b as be,c as Ce,w as ke}from"./en-US.c590db11.js";import"./index.d0776ff2.js";const Y=Symbol("INDEX_BAR_BIND_INDEX_ANCHOR_KEY"),K=Symbol("INDEX_BAR_COUNT_INDEX_ANCHOR_KEY");function Ie(){const{bindChildren:e,childProviders:r}=re(Y),{length:n}=le(K);return{length:n,indexAnchors:r,bindIndexAnchors:e}}function ge(){const{parentProvider:e,bindParent:r}=ie(Y),{index:n}=ce(K);return{index:n,indexBar:e,bindIndexBar:r}}const Te={index:{type:[Number,String]}};const Be=P({name:"VarIndexAnchor",components:{[O.name]:O},inheritAttrs:!1,props:Te,setup(e){const{index:r,indexBar:n,bindIndexBar:l}=ge(),i=c(0),d=c(!1),s=x(()=>e.index),o=c(null);if(!n||!l){console.error('[Varlet] IndexAnchor: You should use this component in "IndexBar"');return}const{active:m,sticky:a,cssMode:A,stickyOffsetTop:E,zIndex:k}=n;return l({index:r,name:s,ownTop:i,setOwnTop:()=>{!o.value||(i.value=o.value.$el?o.value.$el.offsetTop:o.value.offsetTop)},setDisabled:I=>{d.value=I}}),{name:s,anchorEl:o,active:m,sticky:a,zIndex:k,disabled:d,cssMode:A,stickyOffsetTop:E,Transition:Z}}});function Ae(e,r,n,l,i,d){return _(),j(ne(e.sticky?"var-sticky":e.Transition),{"offset-top":e.sticky?e.stickyOffsetTop:null,"z-index":e.sticky?e.zIndex:null,disabled:e.disabled&&!e.cssMode,"css-mode":e.cssMode,ref:"anchorEl"},{default:y(()=>[L("div",ee({class:"var-index-anchor"},e.$attrs),[U(e.$slots,"default",{},()=>[B(f(e.name),1)])],16)]),_:3},8,["offset-top","z-index","disabled","css-mode"])}var q=D(Be,[["render",Ae]]);const Ee={sticky:{type:Boolean,default:!0},stickyOffsetTop:{type:Number,default:0},cssMode:{type:Boolean,default:!1},hideList:{type:Boolean,default:!1},zIndex:{type:[Number,String],default:1},highlightColor:{type:String},duration:{type:[Number,String],default:0},onClick:{type:Function},onChange:{type:Function}};const Ne=P({name:"VarIndexBar",props:Ee,setup(e){const{length:r,indexAnchors:n,bindIndexAnchors:l}=Ie(),i=c(null),d=c(""),s=c(null),o=c(null),m=c([]),a=c(),A=x(()=>e.sticky),E=x(()=>e.cssMode),k=x(()=>e.stickyOffsetTop),N=x(()=>e.zIndex);l({active:a,sticky:A,cssMode:E,stickyOffsetTop:k,zIndex:N});const $=t=>{var v;const u=fe(t)?t.name.value:t;u!==a.value&&(a.value=u,(v=e.onChange)==null||v.call(e,u))},I=()=>{const{scrollTop:t,scrollHeight:u}=i.value,{offsetTop:v}=o.value;n.forEach((h,p)=>{const g=h.ownTop.value,T=t-g+k.value-v,W=p===n.length-1?u:n[p+1].ownTop.value-h.ownTop.value;T>=0&&T<W&&!d.value&&(p&&!e.cssMode&&n[p-1].setDisabled(!0),h.setDisabled(!1),$(h))})},w=async(t,u)=>{var g;if(u&&((g=e.onClick)==null||g.call(e,t)),t===a.value)return;const v=n.find(({name:T})=>t===T.value);if(!v)return;const h=v.ownTop.value,p=_e(i.value);d.value=t,$(t),await me(i.value,{left:p,top:h,animation:de,duration:ue(e.duration)}),he(()=>{d.value=""})},Q=t=>{pe(()=>w(t,!0))};return te(()=>r.value,()=>ae(()=>{n.forEach(({name:t,setOwnTop:u})=>{t.value&&m.value.push(t.value),u()})})),M(()=>{var t;s.value=ve(o.value),i.value=s.value===window?s.value.document.documentElement:s.value,(t=s.value)==null||t.addEventListener("scroll",I)}),se(()=>{var t;(t=s.value)==null||t.removeEventListener("scroll",I)}),{barEl:o,active:a,zIndex:N,anchorNameList:m,scrollTo:Q,anchorClick:w}}}),$e={class:"var-index-bar",ref:"barEl"},Se=["onClick"];function ze(e,r,n,l,i,d){return _(),b("div",$e,[U(e.$slots,"default"),L("ul",{class:"var-index-bar__anchor-list",style:F({zIndex:e.zIndex+2,display:e.hideList?"none":"block"})},[(_(!0),b(R,null,X(e.anchorNameList,s=>(_(),b("li",{key:s,class:oe(["var-index-bar__anchor-item",{"var-index-bar__anchor-item--active":e.active===s}]),style:F({color:e.active===s&&e.highlightColor?e.highlightColor:""}),onClick:o=>e.anchorClick(s)},f(s),15,Se))),128))],4)],512)}var C=D(Ne,[["render",ze]]);C.install=function(e){e.component(C.name,C)};var De={title:"\u6807\u9898",text:"\u6587\u672C"},we={title:"Title",text:"Text"};const{add:G,use:Oe,pack:Pe,packs:Ge,merge:Je}=xe(),je=e=>{Ce(e),Oe(e)};H("zh-CN",ye);H("en-US",be);G("zh-CN",De);G("en-US",we);const Le={name:"IndexBarExample",components:{[C.name]:C,[q.name]:q,[V.name]:V},setup(){const e=c([]);M(()=>{for(let n=0;n<26;n++)e.value.push(String.fromCharCode(65+n))});const r=n=>{console.log(n)};return ke(je),{list:e,pack:Pe,change:r}}};function Ue(e,r,n,l,i,d){const s=S("var-index-anchor"),o=S("var-cell"),m=S("var-index-bar");return _(),j(m,{onChange:l.change,duration:"300","sticky-offset-top":54},{default:y(()=>[(_(!0),b(R,null,X(l.list,a=>(_(),b("div",{key:a},[z(s,{index:a,class:"var-index-anchor__example"},{default:y(()=>[B(f(l.pack.title)+" "+f(a),1)]),_:2},1032,["index"]),z(o,null,{default:y(()=>[B(f(a)+" "+f(l.pack.text),1)]),_:2},1024),z(o,null,{default:y(()=>[B(f(a)+" "+f(l.pack.text),1)]),_:2},1024)]))),128))]),_:1},8,["onChange"])}var Qe=D(Le,[["render",Ue]]);export{Qe as default};
