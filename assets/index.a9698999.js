import{I as Z}from"./index.a43e0611.js";import{R as oe}from"./index.20a388b7.js";import{F as G,u as le}from"./provide.6a63a4bb.js";import{q as re,r as ie,b as H,y as se,Z as B,d as J,e as ue,o as de,c as me,a as K,i as j,h as k,m as O,n as F,Y as ce,P as ye,z as ge}from"./vendor.cfbfc887.js";import{t as a}from"./shared.5973ad73.js";import{t as ve}from"./elements.0f1b5e0a.js";import{u as he}from"./components.092cc01a.js";import{_ as fe}from"./IconSfc.29808136.js";const be={modelValue:{type:[String,Number],default:0},min:{type:[String,Number]},max:{type:[String,Number]},step:{type:[String,Number],default:1},color:{type:String},inputWidth:{type:[String,Number]},inputTextSize:{type:[String,Number]},buttonSize:{type:[String,Number]},decimalLength:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disableIncrement:{type:Boolean,default:!1},disableDecrement:{type:Boolean,default:!1},disableInput:{type:Boolean,default:!1},lazyChange:{type:Boolean,default:!1},incrementButton:{type:Boolean,default:!0},decrementButton:{type:Boolean,default:!0},press:{type:Boolean,default:!0},ripple:{type:Boolean,default:!0},validateTrigger:{type:Array,default:()=>["onInputChange","onLazyChange","onIncrement","onDecrement"]},rules:{type:Array},onBeforeChange:{type:Function},onChange:{type:Function},onIncrement:{type:Function},onDecrement:{type:Function},"onUpdate:modelValue":{type:Function}};const Q=100,R=600,pe=re({name:"VarCounter",components:{[Z.name]:Z,[G.name]:G},directives:{Ripple:oe},inheritAttrs:!1,props:be,setup(e){const i=ie("");let p,z,S,T;const{bindForm:c,form:v}=le(),{errorMessage:V,validateWithTrigger:h,validate:X,resetValidation:D}=he(),{readonly:s,disabled:u}=v!=null?v:{},L=()=>X(e.rules,e.modelValue),C=n=>{ge(()=>{const{validateTrigger:t,rules:o,modelValue:r}=e;h(t,n,o,r)})},$=()=>{var t;const{min:n}=e;(t=e["onUpdate:modelValue"])==null||t.call(e,n!=null?a(n):0),D()},_={reset:$,validate:L,resetValidation:D},A=H(()=>{const{max:n,modelValue:t}=e;return n!=null&&a(t)>=a(n)}),E=H(()=>{const{min:n,modelValue:t}=e;return n!=null&&a(t)<=a(n)}),y=n=>{const{decimalLength:t,max:o,min:r}=e;let l=a(n);return o!=null&&l>a(o)&&(l=a(o)),r!=null&&l<a(r)&&(l=a(r)),n=String(l),t!=null&&(n=l.toFixed(a(t))),n},x=n=>{const{lazyChange:t,onBeforeChange:o}=e,{value:r}=n.target,l=y(r);t?o==null||o(a(l),I):g(l),C("onInputChange")},P=()=>{const{disabled:n,readonly:t,disableDecrement:o,decrementButton:r,lazyChange:l,step:w,modelValue:N,onDecrement:d,onBeforeChange:m}=e;if((u==null?void 0:u.value)||(s==null?void 0:s.value)||n||t||o||!r||E.value)return;const U=new B(a(N)).minus(new B(a(w))).toString(),f=y(U),b=a(f);d==null||d(b),l?m==null||m(b,I):(g(f),C("onDecrement"))},W=()=>{const{disabled:n,readonly:t,disableIncrement:o,incrementButton:r,lazyChange:l,step:w,modelValue:N,onIncrement:d,onBeforeChange:m}=e;if((u==null?void 0:u.value)||(s==null?void 0:s.value)||n||t||o||!r||A.value)return;const U=new B(a(N)).plus(new B(a(w))).toString(),f=y(U),b=a(f);d==null||d(b),l?m==null||m(b,I):(g(f),C("onIncrement"))},ee=()=>{const{press:n,lazyChange:t}=e;!n||t||(T=window.setTimeout(()=>{q()},R))},ne=()=>{const{press:n,lazyChange:t}=e;!n||t||(S=window.setTimeout(()=>{Y()},R))},te=()=>{z&&clearTimeout(z),T&&clearTimeout(T)},ae=()=>{p&&clearTimeout(p),S&&clearTimeout(S)},Y=()=>{p=window.setTimeout(()=>{W(),Y()},Q)},q=()=>{z=window.setTimeout(()=>{P(),q()},Q)},g=n=>{var o;i.value=n;const t=a(n);(o=e["onUpdate:modelValue"])==null||o.call(e,t)},I=n=>{g(y(String(n))),C("onLazyChange")};return c==null||c(_),se(()=>e.modelValue,n=>{var t;g(y(String(n))),(t=e.onChange)==null||t.call(e,a(n))}),g(y(String(e.modelValue))),{inputValue:i,errorMessage:V,formDisabled:u,formReadonly:s,isMax:A,isMin:E,validate:L,reset:$,resetValidation:D,handleChange:x,decrement:P,increment:W,pressDecrement:ee,pressIncrement:ne,releaseDecrement:te,releaseIncrement:ae,toSizeUnit:ve,toNumber:a}}}),ze={class:"var-counter var--box"},Se=["inputmode","readonly","disabled"];function Te(e,i,p,z,S,T){const c=J("var-icon"),v=J("var-form-details"),V=ue("ripple");return de(),me("div",ze,[K("div",ye({class:["var-counter__controller var-elevation--2",[e.disabled||e.formDisabled?"var-counter--disabled":null,e.errorMessage?"var-counter--error":null]],style:{background:e.color?e.color:null}},e.$attrs),[j(k(c,{class:O(["var-counter__decrement-button",[e.decrementButton?null:"var-counter--hidden"]]),"var-counter-cover":"",name:"minus",style:F({width:e.toSizeUnit(e.buttonSize),height:e.toSizeUnit(e.buttonSize)}),onClick:e.decrement,onTouchstart:e.pressDecrement,onTouchend:e.releaseDecrement,onTouchcancel:e.releaseDecrement},null,8,["class","style","onClick","onTouchstart","onTouchend","onTouchcancel"]),[[V,{disabled:!e.ripple||e.disabled||e.readonly||e.disableDecrement||!e.decrementButton||e.isMin}]]),j(K("input",{class:"var-counter__input",style:F({width:e.toSizeUnit(e.inputWidth),fontSize:e.toSizeUnit(e.inputTextSize)}),inputmode:e.toNumber(e.decimalLength)===0?"numeric":"decimal",readonly:e.readonly||e.formReadonly,disabled:e.disabled||e.formDisabled||e.disableInput,"onUpdate:modelValue":i[0]||(i[0]=h=>e.inputValue=h),onChange:i[1]||(i[1]=(...h)=>e.handleChange&&e.handleChange(...h))},null,44,Se),[[ce,e.inputValue]]),j(k(c,{class:O(["var-counter__increment-button",[e.incrementButton?null:"var-counter--hidden"]]),"var-counter-cover":"",name:"plus",style:F({width:e.toSizeUnit(e.buttonSize),height:e.toSizeUnit(e.buttonSize)}),onClick:e.increment,onTouchstart:e.pressIncrement,onTouchend:e.releaseIncrement,onTouchcancel:e.releaseIncrement},null,8,["class","style","onClick","onTouchstart","onTouchend","onTouchcancel"]),[[V,{disabled:!e.ripple||e.disabled||e.readonly||e.disableIncrement||!e.incrementButton||e.isMax}]])],16),k(v,{"error-message":e.errorMessage},null,8,["error-message"])])}var M=fe(pe,[["render",Te]]);M.install=function(e){e.component(M.name,M)};export{M as C};
