import{q as e,r as a,b as n,T as s,o as t,k as o,w as l,a as r,O as i,P as c,R as d,l as u,t as f,y as v,x as p,L as m,c as h,F as x,j as y,m as b,n as k,z as g,d as _,h as I}from"./vendor.bac705d4.js";import{S as T}from"./index.75146e13.js";import{c as C,d as E,e as N,f as z}from"./components.fc1d8498.js";import{_ as B}from"./IconSfc.d1e88af2.js";import{g as O,t as w,a as A}from"./shared.6d6b25a1.js";import{h as S,b as j,s as D,n as M,r as L}from"./elements.f945da86.js";import{C as R}from"./index.ebdee638.js";import{u as $,a as P,_ as X,b as F,c as H,d as U}from"./utils.a0011fda.js";import"./index.deaa662f.js";const V=Symbol("INDEX_BAR_BIND_INDEX_ANCHOR_KEY"),Y=Symbol("INDEX_BAR_COUNT_INDEX_ANCHOR_KEY");const K={index:{type:[Number,String]}};var q=B(e({name:"VarIndexAnchor",components:{[T.name]:T},inheritAttrs:!1,props:K,setup(e){const{index:t,indexBar:o,bindIndexBar:l}=function(){const{parentProvider:e,bindParent:a}=N(V),{index:n}=z(Y);return{index:n,indexBar:e,bindIndexBar:a}}(),r=a(0),i=a(!1),c=n((()=>e.index)),d=a(null);if(!o||!l)return void console.error('[Varlet] IndexAnchor: You should use this component in "IndexBar"');const{active:u,sticky:f,cssMode:v,stickyOffsetTop:p,zIndex:m}=o;return l({index:t,name:c,ownTop:r,setOwnTop:()=>{d.value&&(r.value=d.value.$el?d.value.$el.offsetTop:d.value.offsetTop)},setDisabled:e=>{i.value=e}}),{name:c,anchorEl:d,active:u,sticky:f,zIndex:m,disabled:i,cssMode:v,stickyOffsetTop:p,Transition:s}}}),[["render",function(e,a,n,s,v,p){return t(),o(d(e.sticky?"var-sticky":e.Transition),{"offset-top":e.sticky?e.stickyOffsetTop:null,"z-index":e.sticky?e.zIndex:null,disabled:e.disabled&&!e.cssMode,"css-mode":e.cssMode,ref:"anchorEl"},{default:l((()=>[r("div",c({class:"var-index-anchor"},e.$attrs),[i(e.$slots,"default",{},(()=>[u(f(e.name),1)]))],16)])),_:3},8,["offset-top","z-index","disabled","css-mode"])}]]);const G=e({name:"VarIndexBar",props:{sticky:{type:Boolean,default:!0},stickyOffsetTop:{type:Number,default:0},cssMode:{type:Boolean,default:!1},hideList:{type:Boolean,default:!1},zIndex:{type:[Number,String],default:1},highlightColor:{type:String},duration:{type:[Number,String],default:0},onClick:{type:Function},onChange:{type:Function}},setup(e){const{length:s,indexAnchors:t,bindIndexAnchors:o}=function(){const{bindChildren:e,childProviders:a}=C(V),{length:n}=E(Y);return{length:n,indexAnchors:a,bindIndexAnchors:e}}(),l=a(null),r=a(""),i=a(null),c=a(null),d=a([]),u=a(),f=n((()=>e.sticky)),h=n((()=>e.cssMode)),x=n((()=>e.stickyOffsetTop)),y=n((()=>e.zIndex));o({active:u,sticky:f,cssMode:h,stickyOffsetTop:x,zIndex:y});const b=a=>{var n;const s=A(a)?a.name.value:a;s!==u.value&&(u.value=s,null==(n=e.onChange)||n.call(e,s))},k=()=>{const{scrollTop:a,scrollHeight:n}=l.value,{offsetTop:s}=c.value;t.forEach(((o,l)=>{const i=o.ownTop.value,c=a-i+x.value-s,d=l===t.length-1?n:t[l+1].ownTop.value-o.ownTop.value;c>=0&&c<d&&!r.value&&(l&&!e.cssMode&&t[l-1].setDisabled(!0),o.setDisabled(!1),b(o))}))},_=async(a,n)=>{var s;if(n&&(null==(s=e.onClick)||s.call(e,a)),a===u.value)return;const o=t.find((({name:e})=>a===e.value));if(!o)return;const i=o.ownTop.value,c=j(l.value);r.value=a,b(a),await D(l.value,{left:c,top:i,animation:O,duration:w(e.duration)}),M((()=>{r.value=""}))};return v((()=>s.value),(()=>g((()=>{t.forEach((({name:e,setOwnTop:a})=>{e.value&&d.value.push(e.value),a()}))})))),p((()=>{var e;i.value=S(c.value),l.value=i.value===window?i.value.document.documentElement:i.value,null==(e=i.value)||e.addEventListener("scroll",k)})),m((()=>{var e;null==(e=i.value)||e.removeEventListener("scroll",k)})),{barEl:c,active:u,zIndex:y,anchorNameList:d,scrollTo:e=>{L((()=>_(e,!0)))},anchorClick:_}}}),J={class:"var-index-bar",ref:"barEl"},Q=["onClick"];var W=B(G,[["render",function(e,a,n,s,o,l){return t(),h("div",J,[i(e.$slots,"default"),r("ul",{class:"var-index-bar__anchor-list",style:k({zIndex:e.zIndex+2,display:e.hideList?"none":"block"})},[(t(!0),h(x,null,y(e.anchorNameList,(a=>(t(),h("li",{key:a,class:b(["var-index-bar__anchor-item",{"var-index-bar__anchor-item--active":e.active===a}]),style:k({color:e.active===a&&e.highlightColor?e.highlightColor:""}),onClick:n=>e.anchorClick(a)},f(a),15,Q)))),128))],4)],512)}]]);W.install=function(e){e.component(W.name,W)};const{add:Z,use:ee,pack:ae,packs:ne,merge:se}=$(),te=e=>{H(e),ee(e)};P("zh-CN",X),P("en-US",F),Z("zh-CN",{title:"标题",text:"文本"}),Z("en-US",{title:"Title",text:"Text"});var oe=B({name:"IndexBarExample",components:{[W.name]:W,[q.name]:q,[R.name]:R},setup(){const e=a([]);p((()=>{for(let a=0;a<26;a++)e.value.push(String.fromCharCode(65+a))}));return U(te),{list:e,pack:ae,change:e=>{console.log(e)}}}},[["render",function(e,a,n,s,r,i){const c=_("var-index-anchor"),d=_("var-cell"),v=_("var-index-bar");return t(),o(v,{onChange:s.change,duration:"300","sticky-offset-top":50},{default:l((()=>[(t(!0),h(x,null,y(s.list,(e=>(t(),h("div",{key:e},[I(c,{index:e,class:"var-index-anchor__example"},{default:l((()=>[u(f(s.pack.title)+" "+f(e),1)])),_:2},1032,["index"]),I(d,null,{default:l((()=>[u(f(e)+" "+f(s.pack.text),1)])),_:2},1024),I(d,null,{default:l((()=>[u(f(e)+" "+f(s.pack.text),1)])),_:2},1024)])))),128))])),_:1},8,["onChange"])}]]);export{oe as default};
