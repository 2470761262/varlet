import{I as e}from"./index.5f8c0dc7.js";import{R as n}from"./index.b3b1e3ce.js";import{F as t,u as a}from"./provide.92d12d40.js";import{q as o,r,b as l,y as i,Z as s,d as u,e as d,o as c,c as m,a as p,i as g,h as y,m as h,n as b,Y as v,P as f,z as S}from"./vendor.85536c59.js";import{t as C}from"./shared.6d6b25a1.js";import{t as T}from"./elements.f945da86.js";import{b as z}from"./components.0481fe69.js";import{_ as B}from"./IconSfc.fde87e76.js";const V={modelValue:{type:[String,Number],default:0},min:{type:[String,Number]},max:{type:[String,Number]},step:{type:[String,Number],default:1},color:{type:String},inputWidth:{type:[String,Number]},inputTextSize:{type:[String,Number]},buttonSize:{type:[String,Number]},decimalLength:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disableIncrement:{type:Boolean,default:!1},disableDecrement:{type:Boolean,default:!1},disableInput:{type:Boolean,default:!1},lazyChange:{type:Boolean,default:!1},incrementButton:{type:Boolean,default:!0},decrementButton:{type:Boolean,default:!0},press:{type:Boolean,default:!0},ripple:{type:Boolean,default:!0},validateTrigger:{type:Array,default:()=>["onInputChange","onLazyChange","onIncrement","onDecrement"]},rules:{type:Array},onBeforeChange:{type:Function},onChange:{type:Function},onIncrement:{type:Function},onDecrement:{type:Function},"onUpdate:modelValue":{type:Function}};const I=o({name:"VarCounter",components:{[e.name]:e,[t.name]:t},directives:{Ripple:n},inheritAttrs:!1,props:V,setup(e){const n=r("");let t,o,u,d;const{bindForm:c,form:m}=a(),{errorMessage:p,validateWithTrigger:g,validate:y,resetValidation:h}=z(),{readonly:b,disabled:v}=null!=m?m:{},f=()=>y(e.rules,e.modelValue),B=n=>{S((()=>{const{validateTrigger:t,rules:a,modelValue:o}=e;g(t,n,a,o)}))},V=()=>{var n;const{min:t}=e;null==(n=e["onUpdate:modelValue"])||n.call(e,null!=t?C(t):0),h()},I={reset:V,validate:f,resetValidation:h},w=l((()=>{const{max:n,modelValue:t}=e;return null!=n&&C(t)>=C(n)})),D=l((()=>{const{min:n,modelValue:t}=e;return null!=n&&C(t)<=C(n)})),x=n=>{const{decimalLength:t,max:a,min:o}=e;let r=C(n);return null!=a&&r>C(a)&&(r=C(a)),null!=o&&r<C(o)&&(r=C(o)),n=String(r),null!=t&&(n=r.toFixed(C(t))),n},U=()=>{const{disabled:n,readonly:t,disableDecrement:a,decrementButton:o,lazyChange:r,step:l,modelValue:i,onDecrement:u,onBeforeChange:d}=e;if((null==v?void 0:v.value)||(null==b?void 0:b.value)||n||t||a||!o)return;if(D.value)return;const c=new s(C(i)).minus(new s(C(l))).toString(),m=x(c),p=C(m);null==u||u(p),r?null==d||d(p,M):(F(m),B("onDecrement"))},N=()=>{const{disabled:n,readonly:t,disableIncrement:a,incrementButton:o,lazyChange:r,step:l,modelValue:i,onIncrement:u,onBeforeChange:d}=e;if((null==v?void 0:v.value)||(null==b?void 0:b.value)||n||t||a||!o)return;if(w.value)return;const c=new s(C(i)).plus(new s(C(l))).toString(),m=x(c),p=C(m);null==u||u(p),r?null==d||d(p,M):(F(m),B("onIncrement"))},_=()=>{t=window.setTimeout((()=>{N(),_()}),100)},j=()=>{o=window.setTimeout((()=>{U(),j()}),100)},F=t=>{var a;n.value=t;const o=C(t);null==(a=e["onUpdate:modelValue"])||a.call(e,o)},M=e=>{F(x(String(e))),B("onLazyChange")};return null==c||c(I),i((()=>e.modelValue),(n=>{var t;F(x(String(n))),null==(t=e.onChange)||t.call(e,C(n))})),F(x(String(e.modelValue))),{inputValue:n,errorMessage:p,formDisabled:v,formReadonly:b,isMax:w,isMin:D,validate:f,reset:V,resetValidation:h,handleChange:n=>{const{lazyChange:t,onBeforeChange:a}=e,{value:o}=n.target,r=x(o);t?null==a||a(C(r),M):F(r),B("onInputChange")},decrement:U,increment:N,pressDecrement:()=>{const{press:n,lazyChange:t}=e;n&&!t&&(d=window.setTimeout((()=>{j()}),600))},pressIncrement:()=>{const{press:n,lazyChange:t}=e;n&&!t&&(u=window.setTimeout((()=>{_()}),600))},releaseDecrement:()=>{o&&clearTimeout(o),d&&clearTimeout(d)},releaseIncrement:()=>{t&&clearTimeout(t),u&&clearTimeout(u)},toSizeUnit:T,toNumber:C}}}),w={class:"var-counter var--box"},D=["inputmode","readonly","disabled"];var x=B(I,[["render",function(e,n,t,a,o,r){const l=u("var-icon"),i=u("var-form-details"),s=d("ripple");return c(),m("div",w,[p("div",f({class:["var-counter__controller var-elevation--2",[e.disabled||e.formDisabled?"var-counter--disabled":null,e.errorMessage?"var-counter--error":null]],style:{background:e.color?e.color:null}},e.$attrs),[g(y(l,{class:h(["var-counter__decrement-button",[e.decrementButton?null:"var-counter--hidden"]]),"var-counter-cover":"",name:"minus",style:b({width:e.toSizeUnit(e.buttonSize),height:e.toSizeUnit(e.buttonSize)}),onClick:e.decrement,onTouchstart:e.pressDecrement,onTouchend:e.releaseDecrement,onTouchcancel:e.releaseDecrement},null,8,["class","style","onClick","onTouchstart","onTouchend","onTouchcancel"]),[[s,{disabled:!e.ripple||e.disabled||e.readonly||e.disableDecrement||!e.decrementButton||e.isMin}]]),g(p("input",{class:"var-counter__input",style:b({width:e.toSizeUnit(e.inputWidth),fontSize:e.toSizeUnit(e.inputTextSize)}),inputmode:0===e.toNumber(e.decimalLength)?"numeric":"decimal",readonly:e.readonly||e.formReadonly,disabled:e.disabled||e.formDisabled||e.disableInput,"onUpdate:modelValue":n[0]||(n[0]=n=>e.inputValue=n),onChange:n[1]||(n[1]=(...n)=>e.handleChange&&e.handleChange(...n))},null,44,D),[[v,e.inputValue]]),g(y(l,{class:h(["var-counter__increment-button",[e.incrementButton?null:"var-counter--hidden"]]),"var-counter-cover":"",name:"plus",style:b({width:e.toSizeUnit(e.buttonSize),height:e.toSizeUnit(e.buttonSize)}),onClick:e.increment,onTouchstart:e.pressIncrement,onTouchend:e.releaseIncrement,onTouchcancel:e.releaseIncrement},null,8,["class","style","onClick","onTouchstart","onTouchend","onTouchcancel"]),[[s,{disabled:!e.ripple||e.disabled||e.readonly||e.disableIncrement||!e.incrementButton||e.isMax}]])],16),y(i,{"error-message":e.errorMessage},null,8,["error-message"])])}]]);x.install=function(e){e.component(x.name,x)};export{x as C};
