import{u as e}from"./provide.1671a24a.js";import{n as a}from"./elements.f945da86.js";import{t as l,f as t}from"./shared.6d6b25a1.js";import{_ as n}from"./IconSfc.7d4b9349.js";import{q as u,r as o,b as v,y as r,x as i,G as s,o as c,c as d,a as h,O as p,m as f,n as m,F as w,i as T,f as b}from"./vendor.613212a8.js";const g={loop:{type:Boolean,default:!0},autoplay:{type:[String,Number]},duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:{type:String},vertical:{type:Boolean,default:!1},touchable:{type:Boolean,default:!0},onChange:{type:Function}};const y=u({name:"VarSwipe",props:g,setup(n){const u=o(null),c=o(0),d=v((()=>n.vertical)),h=o(0),p=o(0),f=o(!1),m=o(0),{swipeItems:w,bindSwipeItems:T,length:b}=e();let g,y,x,k,S,z=!1,C=-1;const $=e=>w.find((({index:a})=>a.value===e)),_=e=>{const a=t(e)?e:Math.floor((p.value-c.value/2)/-c.value),{loop:l}=n;return a<=-1?l?-1:0:a>=b.value?l?b.value:b.value-1:a},I=e=>{const{loop:a}=n;return e<0?a?b.value-1:0:e>b.value-1?a?0:b.value-1:e},M=e=>{const l=p.value>=c.value,t=p.value<=-h.value,n=-(h.value-c.value);f.value=!0,(l||t)&&(f.value=!0,p.value=t?0:n,$(0).setTranslate(0),$(b.value-1).setTranslate(0)),a((()=>{f.value=!1,null==e||e()}))},j=()=>{const{autoplay:e}=n;!e||b.value<=1||(E(),C=window.setTimeout((()=>{B(),j()}),l(e)))},E=()=>{C&&clearInterval(C)},N=()=>{c.value=n.vertical?u.value.offsetHeight:u.value.offsetWidth,h.value=c.value*b.value,f.value=!0,m.value=I(l(n.initialIndex)),p.value=m.value*-c.value,a((()=>{f.value=!1})),j()},B=()=>{if(b.value<=1)return;const{loop:e,onChange:a}=n,l=m.value;m.value=I(l+1),null==a||a(m.value),M((()=>{if(l===b.value-1&&e)return $(0).setTranslate(h.value),void(p.value=b.value*-c.value);l!==b.value-1&&(p.value=m.value*-c.value)}))},D=()=>{if(b.value<=1)return;const{loop:e,onChange:a}=n,l=m.value;m.value=I(l-1),null==a||a(m.value),M((()=>{if(0===l&&e)return $(b.value-1).setTranslate(-h.value),void(p.value=c.value);0!==l&&(p.value=m.value*-c.value)}))};return T({size:c,vertical:d}),r((()=>b.value),N),i((()=>{window.addEventListener("resize",N)})),s((()=>{window.removeEventListener("resize",N),E()})),{length:b,index:m,swipeEl:u,trackSize:h,translate:p,lockDuration:f,handleTouchstart:e=>{if(b.value<=1||!n.touchable)return;const{clientX:a,clientY:l}=e.touches[0];g=a,y=l,x=performance.now(),z=!0,E(),M((()=>{f.value=!0}))},handleTouchmove:e=>{const{touchable:a,vertical:l}=n;if(!z||!a)return;const{clientX:t,clientY:u}=e.touches[0],o=Math.abs(t-g),v=Math.abs(u-y);var r,i;if(((r=o)>(i=v)&&r>10?"horizontal":i>r&&i>10?"vertical":void 0)===(l?"vertical":"horizontal")){e.preventDefault();const a=void 0!==k?t-k:0,o=void 0!==S?u-S:0;k=t,S=u,p.value+=l?o:a,n.loop&&(p.value>=0&&$(b.value-1).setTranslate(-h.value),p.value<=-(h.value-c.value)&&$(0).setTranslate(h.value),p.value>-(h.value-c.value)&&p.value<0&&($(b.value-1).setTranslate(0),$(0).setTranslate(0)))}},handleTouchend:()=>{if(!z)return;const{vertical:e,onChange:a}=n,l=e?S<y:k<g,t=e?Math.abs(y-S):Math.abs(g-k),u=performance.now()-x<=250&&t>=20?_(l?m.value+1:m.value-1):_();z=!1,f.value=!1,k=void 0,S=void 0,p.value=u*-c.value;const o=m.value;m.value=(e=>{const{loop:a}=n;return-1===e?a?b.value-1:0:e===b.value?a?0:b.value-1:e})(u),j(),o!==m.value&&(null==a||a(m.value))},next:B,prev:D,to:e=>{if(b.value<=1||e===m.value)return;const a=(e=(e=e<0?0:e)>=b.value?b.value:e)>m.value?B:D;Array.from({length:Math.abs(e-m.value)}).forEach(a)},resize:N,toNumber:l}}}),x={class:"var-swipe",ref:"swipeEl"},k=["onClick"];var S=n(y,[["render",function(e,a,l,t,n,u){return c(),d("div",x,[h("div",{class:f(["var-swipe__track",[e.vertical?"var-swipe--vertical":null]]),style:m({width:e.vertical?null:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:null,transform:`translate${e.vertical?"Y":"X"}(${e.translate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:a[0]||(a[0]=(...a)=>e.handleTouchstart&&e.handleTouchstart(...a)),onTouchmove:a[1]||(a[1]=(...a)=>e.handleTouchmove&&e.handleTouchmove(...a)),onTouchend:a[2]||(a[2]=(...a)=>e.handleTouchend&&e.handleTouchend(...a))},[p(e.$slots,"default")],38),p(e.$slots,"indicator",{index:e.index,length:e.length},(()=>[e.indicator&&e.length?(c(),d("div",{key:0,class:f(["var-swipe__indicators",[e.vertical?"var-swipe--indicators-vertical":null]])},[(c(!0),d(w,null,T(e.length,((a,l)=>(c(),d("div",{class:f(["var-swipe__indicator",[e.index===l?"var-swipe--indicator-active":null,e.vertical?"var-swipe--indicator-vertical":null]]),style:m({background:e.indicatorColor}),key:a,onClick:a=>e.to(l)},null,14,k)))),128))],2)):b("v-if",!0)]))],512)}]]);S.install=function(e){e.component(S.name,S)};export{S,g as p};
